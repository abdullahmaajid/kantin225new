<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Submission to Google Sheets</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>Submit Your Name and Age</h1>
    <form id="dataForm">
        <label for="name">Name:</label>
        <input type="text" id="name" required><br><br>
        <label for="age">Age:</label>
        <input type="number" id="age" required><br><br>
        <button type="submit">Submit</button>
    </form>

    <script>
        const API_KEY = 'AIzaSyD7DvygeErKiIOhihTuZG02K8Pu8QRc4Fo'; // Your API Key
        const SPREADSHEET_ID = '1MVDDoHqo7JoBRxfuYb98dYggEl39aNdJSE0kafLP9RY'; // Your Spreadsheet ID

        $(document).ready(function () {
            $('#dataForm').on('submit', function (event) {
                event.preventDefault(); // Prevent the default form submission
                
                const name = $('#name').val();
                const age = $('#age').val();
                
                const url = `https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/Sheet1!A:B:append?valueInputOption=RAW&key=${API_KEY}`;
                const data = {
                    values: [[name, age]]
                };

                $.ajax({
                    url: url,
                    method: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify(data),
                    success: function (response) {
                        alert('Data submitted successfully!');
                        $('#dataForm')[0].reset(); // Reset the form after submission
                    },
                    eerror: function (xhr, status, error) {
                        console.error('Error submitting data:', error);
                        console.error('Response:', xhr.responseText);
                        alert('Failed to submit data: ' + xhr.responseText);
                    }
                });
            });
        });
    </script>
</body>
</html>
