<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kantin 225 - Order Menu</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/react@17/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@17/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/babel-standalone@6/babel.min.js"></script>
  <style>
    .menu-items {
      height: 660px;
      overflow-y: auto;
      border: 1px solid #dedede;
      padding: 10px;
  }
  
  .order-summary {
      border-left: 2px solid #dedede;
      padding-left: 20px;
  }
  
  .remove-btn {
      background-color: #e74c3c;
      color: white;
      border: none;
      padding: 0.3rem 0.6rem;
      font-size: 0.8rem;
      cursor: pointer;
  }
  
  .cart-items {
      height: 350px;
      max-height: 330px;
      overflow-y: auto;
      margin-bottom: 10px;
  }
  
  .checkout-section {
      border-top: 1px solid #dedede;
      padding-top: 10px;
  }
  
  .error-message {
      color: red;
  }
  
  .filter-buttons {
      display: flex;
      justify-content: center; /* Center the buttons */
      gap: 20px; /* Space between buttons */
      align-items: center; /* Align items vertically in the center */
  }
  
  .filter-button {
      border: none; /* Remove button border */
      background: none; /* Remove background color */
      padding: 0; /* Remove padding */
      cursor: pointer; /* Show pointer cursor on hover */
      outline: none; /* Remove default button outline */
  }
  
  .filter-button img {
      width: 70px; /* Adjust image size */
      height: auto; /* Maintain aspect ratio */
      display: block; /* Make sure the image is displayed as a block element */
  }
  
  .filter-button:focus,
  .filter-button:active {
      outline: none; /* Disable focus/active outline */
  }
  
  .menu-items .card {
    width: 130px; /* Set a fixed width for the card */
    margin: 0 auto; /* Center the card horizontally */
    transition: transform 0.2s ease; /* Add transition for smooth scaling */
}

.menu-items .card img {
  padding: 10px;
    width: 100%; /* Set a maximum height for the images */
    transition: transform 0.3s; /* Add a smooth zoom effect */
}

.menu-items .card-body {
  display: flex;
  flex-direction: column;

  height: 130px; /* Set a fixed height for the card body to create consistency */
}


.card-text {
  font-size: 1em;
  text-align: center;
  margin-top: auto; /* Push the price to the bottom of the card */
  padding-top: 0px; /* Add some space between the name and the price */
}



.menu-items .card img:hover {
    transform: scale(1.05); /* Scale the image slightly on hover for a zoom effect */
}

/* Click effect */
.menu-items .card.clicked {
    transform: scale(1.05); /* Slightly enlarge the card */
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); /* Add a shadow effect */
}

.card-title {
    font-size: 1.2em; /* Set a font size for the item name */
    text-align: center; /* Center align the title */
}

.card-text {
    font-size: 1em; /* Set a font size for the price */
    text-align: center; /* Center align the text */
}
     
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">

    
    const { useState, useEffect } = React;

    // Menu Items (simulated as local data)
    const menuItems = [
  { id: 1, category: "Makanan", name: "Nasi Soto Ayam Campur", price: 10000, img: "image/sotocampur.png" },
  { id: 2, category: "Makanan", name: "Nasi Pecel", price: 7000, img: "image/nasipecel.png" },
  { id: 3, category: "Makanan", name: "Nasi Rames", price: 10000, img: "image/nasirames.png" },
  { id: 4, category: "Makanan", name: "Nasi Goreng Telur", price: 12000, img: "image/nasigorengtelur.png" },
  { id: 5, category: "Makanan", name: "Nasi Ayam Penyet", price: 14000, img: "image/nasiayampenyet.png" },
  { id: 6, category: "Makanan", name: "Nasi Soto Pisah", price: 12000, img: "image/nasisotopisah.png" },
  { id: 7, category: "Makanan", name: "Bakmie Goreng", price: 12000, img: "image/bakmiegoreng.png" },
  { id: 8, category: "Makanan", name: "Bakmie Rebus", price: 12000, img: "image/bakmierebus.png" },
  { id: 9, category: "Makanan", name: "Indomie Goreng", price: 5000, img: "image/indomiegoreng.png" },
  { id: 10, category: "Makanan", name: "Indomie Rebus", price: 5000, img: "image/indomierebus.png" },
  { id: 11, category: "Makanan", name: "Gado-Gado", price: 13000, img: "image/gadogado.png" },
  { id: 12, category: "Makanan", name: "Nasi Putih", price: 3000, img: "image/nasiputih.png" },
  { id: 13, category: "Makanan", name: "Magelangan", price: 12000, img: "image/magelangan.png" },
  { id: 14, category: "Topping", name: "Telur Dadar", price: 3000, img: "image/telurdadar.png" },
  { id: 15, category: "Topping", name: "Telur Ceplok", price: 3000, img: "image/telurceplok.png" },
  { id: 16, category: "Topping", name: "Telur Asin", price: 4000, img: "image/telurasin.png" },
  { id: 17, category: "Topping", name: "Ayam Suwir", price: 4000, img: "image/ayamsuwir.png" },
  { id: 18, category: "Topping", name: "Kremes", price: 2500, img: "image/kremes.png" },
  { id: 19, category: "Topping", name: "Tempe Goreng", price: 2000, img: "image/tempegoreng.png" },
  { id: 20, category: "Topping", name: "Tahu Goreng", price: 2000, img: "image/tahugoreng.png" },
  { id: 21, category: "Topping", name: "Sambal Terasi", price: 3000, img: "image/sambalterasi.png" },
  { id: 22, category: "Minuman", name: "Teh Panas", price: 3000, img: "image/tehpanas.png" },
  { id: 23, category: "Minuman", name: "Es Teh", price: 3000, img: "image/esteh.png" },
  { id: 24, category: "Minuman", name: "Jeruk Panas", price: 4000, img: "image/jerukpanas.png" },
  { id: 25, category: "Minuman", name: "Es Jeruk", price: 4000, img: "image/esjeruk.png" }
];

    function App() {
        const [transferProof, setTransferProof] = useState(null);
        const [filter, setFilter] = useState("All");
        const [cart, setCart] = useState([]);
        const [search, setSearch] = useState("");
        const [customerName, setCustomerName] = useState("");
        const [selectedDate, setSelectedDate] = useState("");
        const [paymentMethod, setPaymentMethod] = useState("cash");
        const [amountPaid, setAmountPaid] = useState(null);
        const [change, setChange] = useState(0);
        const [errorMessage, setErrorMessage] = useState("");
      
        useEffect(() => {
          const savedCart = localStorage.getItem("cart");
          if (savedCart) {
            setCart(JSON.parse(savedCart));
          }
        }, []);
      
        useEffect(() => {
          localStorage.setItem("cart", JSON.stringify(cart));
        }, [cart]);
      
        const filteredItems = menuItems.filter(
          item => (filter === "All" || item.category === filter) &&
                  item.name.toLowerCase().includes(search.toLowerCase())
        );
      
        const addToCart = (item) => {
          setCart(prevCart => {
            const existingItem = prevCart.find(cartItem => cartItem.id === item.id);
            if (existingItem) {
              return prevCart.map(cartItem =>
                cartItem.id === item.id ? { ...cartItem, qty: cartItem.qty + 1 } : cartItem
              );
            }
            return [...prevCart, { ...item, qty: 1 }];
          });
        };
      
        const handleQuantityChange = (id, delta) => {
          setCart(prevCart =>
            prevCart.map(item => 
              item.id === id && item.qty + delta > 0
                ? { ...item, qty: item.qty + delta }
                : item
            )
          );
        };
      
        const removeFromCart = (id) => {
          setCart(prevCart => prevCart.filter(item => item.id !== id));
        };
      
        const totalPrice = cart.reduce((total, item) => total + item.qty * item.price, 0);
      
        const handlePaymentChange = (e) => {
          setPaymentMethod(e.target.value);
        };
      
        useEffect(() => {
          if (paymentMethod === "cash") {
            setChange(amountPaid - totalPrice);
          } else {
            setChange(0);
          }
        }, [amountPaid, totalPrice, paymentMethod]);
      
        const setTodayDate = () => {
          setSelectedDate(new Date().toISOString().split("T")[0]);
        };
      
        const handleFileChange = (e) => {
          const file = e.target.files[0];
          if (file) {
            setTransferProof(URL.createObjectURL(file)); // Create a URL for the selected file
          }
        };
      
        const handleCheckout = () => {
          if (cart.length === 0) {
              alert("Keranjang kosong. Tambahkan pesanan terlebih dahulu.");
              return;
          }
      
          if (paymentMethod === "cash" && (amountPaid === null || amountPaid < totalPrice)) {
              setErrorMessage("Uang tidak cukup!");
              return;
          }
      
          const order = {
              customerName,
              date: selectedDate,
              paymentMethod,
              items: cart.map(item => ({
                  name: item.name,
                  qty: item.qty,
                  price: item.price,
                  total: item.price * item.qty // Calculate total for each item
              })),
              totalPrice, // Grand total for the order
              amountPaid, // Save the amount paid
              change,     // Save the change
              transferProof: paymentMethod === "digital" ? transferProof : null // Save transfer proof if payment is digital
          };
      
          // Save the order to localStorage
          const previousOrders = JSON.parse(localStorage.getItem("orders")) || [];
          localStorage.setItem("orders", JSON.stringify([...previousOrders, order]));
      
          alert("Pesanan berhasil disimpan!");
      
          // Clear cart and reset form
          setCart([]);
          setCustomerName("");
          setSelectedDate("");
          setPaymentMethod("cash");
          setAmountPaid(0);
          setChange(0);
          setErrorMessage("");
          setTransferProof(null); // Reset transfer proof
      };
      
        
        
      
        return (
  <div className="container mt-4">


    
    <h1 className="text-center">Kantin 225</h1>   
    
    
    
            <div className="row mt-5">
              <div className="col-md-6">
                <h3>Menu</h3>
<input
  type="text"
  className="form-control mb-3"
  placeholder="Cari Menu..."
  value={search}
  onChange={e => setSearch(e.target.value)}
/>

<div className="filter-buttons mb-3">
  <button
    className="filter-button"
    onClick={() => setFilter('All')}
  >
    <img src="image/all.png" alt="" />
  </button>
  <button
    className="filter-button"
    onClick={() => setFilter('Makanan')}
  >
    <img src="image/makanan.png" alt="" />
  </button>
  <button
    className="filter-button"
    onClick={() => setFilter('Topping')}
  >
    <img src="image/topping.png" alt="" />
  </button>
  <button
    className="filter-button"
    onClick={() => setFilter('Minuman')}
  >
    <img src="image/minuman.png" alt="" />
  </button>
</div>



<div className="menu-items">
  <div className="row">
    {filteredItems.map(item => (
      <div className="col-md-3 mb-3" key={item.id}>
        <div className="card h-100" style={{ cursor: 'pointer' }} onClick={() => addToCart(item)}>
          <img
            src={item.img}
            alt={item.name}
            className="card-img-top"
            style={{ height: '100px', objectFit: 'cover' }} // Adjust height as needed
          />
          <div className="card-body text-center">
            <h5 className="card-title">{item.name}</h5>
            <p className="card-text">Rp. {item.price.toLocaleString()}</p>
          </div>
        </div>
      </div>
    ))}
  </div>
</div>


                  

                  
              </div>
      
              <div className="col-md-6 order-summary">
                <h3>Ringkasan Pesanan</h3>




                <div className="cart-items">
  <table className="table">
    <thead>
      <tr>
        <th>Menu</th>
        <th>Jumlah</th>
        <th>Harga</th>
        <th>Total</th>
        <th>Aksi</th>
      </tr>
    </thead>
    <tbody>
      {cart.map(item => (
        <tr key={item.id}>
          <td>{item.name}</td>
          <td>
            <div className="d-flex align-items-center">
              <button
                className="btn btn-sm btn-warning"
                onClick={() => handleQuantityChange(item.id, 1)}
              >
                +
              </button>
              <span className="mx-2">{item.qty}</span>
              <button
                className="btn btn-sm btn-danger"
                onClick={() => handleQuantityChange(item.id, -1)}
              >
                -
              </button>
            </div>
          </td>
          <td>Rp. {item.price.toLocaleString()}</td>
          <td>Rp. {(item.price * item.qty).toLocaleString()}</td> {/* Display total per item */}
          <td>
            <button
              className="remove-btn"
              onClick={() => removeFromCart(item.id)}
            >
              Hapus
            </button>
          </td>
        </tr>
      ))}
    </tbody>
  </table>
  <h4>Total Grand: Rp. {totalPrice.toLocaleString()}</h4> {/* Display grand total */}
</div>

      
                <div className="checkout-section">
                  <div className="mb-3">
                    <label>Nama Pelanggan:</label>
                    <input
                      type="text"
                      className="form-control"
                      value={customerName}
                      onChange={e => setCustomerName(e.target.value)}
                    />
                  </div>
                  <div className="mb-3">
                    <label>Tanggal:</label>
                    <input
                      type="date"
                      className="form-control"
                      value={selectedDate}
                      onChange={e => setSelectedDate(e.target.value)}
                      onFocus={setTodayDate}
                    />
                  </div>
                  <div className="mb-3">
                    <label>Metode Pembayaran:</label>
                    <select
                      className="form-select"
                      value={paymentMethod}
                      onChange={handlePaymentChange}
                    >
                      <option value="cash">Cash</option>
                      <option value="digital">QRIS</option>
                    </select>
                  </div>
                  {paymentMethod === "cash" && (
                    <div className="mb-3">
                      <label>Jumlah yang Dibayar:</label>
                      <input
                        type="number"
                        className="form-control"
                        value={amountPaid || ""}
                        onChange={e => setAmountPaid(parseFloat(e.target.value) || 0)}
                      />
                      {errorMessage && <div className="text-danger">{errorMessage}</div>}
                      <div>Kembalian: Rp. {change.toLocaleString()}</div>
                    </div>
                  )}
                  {paymentMethod === "digital" && (
                    <div className="mb-3">
                      <label>Unggah Bukti Transfer:</label>
                      <input
                        type="file"
                        className="form-control"
                        accept="image/*"
                        onChange={handleFileChange} // Update the handler to this new one
                      />
                      {transferProof && ( // Display the image if transferProof is not null
                        <div className="mt-2">
                          <h5>Bukti Transfer:</h5>
                          <img src={transferProof} alt="Transfer Proof" style={{ width: "100%", maxWidth: "300px" }} />
                        </div>
                      )}
                    </div>
                  )}
                  <button className="btn btn-success" onClick={handleCheckout}>
                    Simpan
                  </button>
                </div>
              </div>
            </div>
          </div>
        );
      }

    ReactDOM.render(<App />, document.getElementById("root"));
  </script>
</body>
</html>
